<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<title>Sophie Bluel - Architecte d'intérieur</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Work+Sans&display=swap"
		rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<meta name="description" content="">
	<link rel="stylesheet" href="./assets/style.css">
	<script type="module" src="./scripts/main.js" defer></script>
</head>

<body>
	<header>
		<div class="edit-banner no-display">
			<i class="fa-regular fa-pen-to-square"></i>
			<span>Mode édition</span>
		</div>
		<div id="nav-container">
			<h1>Sophie Bluel <span>Architecte d'intérieur</span></h1>
			<nav>
				<ul>
					<li><a href="#portfolio" class="smooth-transition">projets</a></li>
					<li><a href="#contact">contact</a></li>
					<li><a href="pages/login.html" class="login">login</a></li>
					<li><a href="#" class="logout">logout</a></li>
					<li><a href="https://www.instagram.com/"><img src="./assets/icons/instagram.png" id="instagram-logo"
								alt="Instagram"></a></li>
				</ul>
			</nav>
		</div>
	</header>
	<main>
		<form method="post">
			<div class="modal">
				<div class="form-container">
					<div>
						<div class="modal-nav">
							<span class="close">&times;</span>
						</div>
						<h3>Ajout photo</h3>
					</div>
					<div class="modal-content">
						<div class="upload-section">
							<label for="photo-upload" class="upload-label">
								<div class="upload-preview">
									<div class="img-container">
										<img id="preview-image" class="no-display" src="#" alt="Aperçu">
									</div>
									<i class="fa-regular fa-image"></i>
								</div>
								<input type="file" id="photo-upload" accept="image/png, image/jpeg" hidden>
								<a class="button add-pic">+ Ajouter photo</a>
								<span class="info">jpg, png : 4mo max</span>
							</label>
						</div>
						<div>
							<label class="form-label" for="photo-title">Titre</label>
							<input type="text" id="photo-title">
						</div>
						<div>
							<label class="form-label" for="photo-category">Catégorie</label>
							<div class="select-container">
								<i class="fa-solid fa-chevron-down"></i>
								<select id="photo-category">
									<option value="" disabled selected></option>
									<option value="objets">Objets</option>
									<option value="appartements">Appartements</option>
									<option value="hotels & restaurants">Hotels & restaurants</option>
								</select>

							</div>
						</div>
					</div>
					<button id="validate-button" disabled>Valider</button>
				</div>
			</div>
		</form>
	</main>

	<footer>
		<nav>
			<ul>
				<li><a href="#mention">Mentions Légales</a></li>
			</ul>
		</nav>
	</footer>
</body>

<script>


	function imgPreview() {
		const fileInput = document.getElementById("photo-upload");
		const previewImage = document.getElementById("preview-image");

		fileInput.addEventListener("change", (event) => {
			// Supprime le message d'erreur s'il existe déjà
			const existingError = document.querySelector(".upload-section .error");
			let shake = "";
			if (existingError) {
				existingError.remove();
				shake = "shake";
			}

			const file = event.target.files[0];

			if (file && file.size <= 4 * 1024 * 1024 &&
				(file.type === "image/png" || file.type === "image/jpeg")) { // Fichier valide (<= 4 Mo)
				const reader = new FileReader();
				reader.onload = (e) => {
					previewImage.src = e.target.result;
					previewImage.style.display = "block"; // Réaffiche l'image après le chargement
				};
				reader.readAsDataURL(file);

				// Met à jour la zone de prévisualisation sans supprimer les éléments
				const uploadPreview = document.querySelector(".upload-label");
				uploadPreview.innerHTML = "";
				uploadPreview.appendChild(fileInput);
				uploadPreview.appendChild(previewImage);
			} else {
				// Réinitialise l'input pour autoriser une nouvelle sélection
				fileInput.value = "";
				// Affiche le message d'erreur sans supprimer les autres éléments
				const uploadSection = document.querySelector(".upload-label");
				if (file.size > 4 * 1024 * 1024)
					uploadSection.insertAdjacentHTML("beforeend", `<span class="error ${shake}">Fichier trop volumineux</span>`);
				else
					uploadSection.insertAdjacentHTML("beforeend", `<span class="error ${shake}">Type de fichier invalide</span>`);
			}
		});
	}

	function checkFormValidity() {
		document.addEventListener("DOMContentLoaded", () => {
			const fileInput = document.getElementById("photo-upload");
			const titleInput = document.getElementById("photo-title");
			const categorySelect = document.getElementById("photo-category");
			const validateButton = document.getElementById("validate-button");

			function updateValidateButtonState() {
				const file = fileInput.files[0];
				const isFileValid = file && file.size <= 4 * 1024 * 1024 &&
					(file.type === "image/png" || file.type === "image/jpeg");
				const isTitleValid = titleInput.value.trim() !== "";
				const isCategoryValid = categorySelect.value !== "";

				validateButton.disabled = !(isFileValid && isTitleValid && isCategoryValid);
			}

			fileInput.addEventListener("change", updateValidateButtonState);
			titleInput.addEventListener("input", updateValidateButtonState);
			categorySelect.addEventListener("change", updateValidateButtonState);
		});
	}
	imgPreview();
	checkFormValidity();
</script>

</html>